import Admonition from "@theme/Admonition";

# Automate SDK Updates

<Admonition type="info" title="Required setup">
  Install [Konfig's GitHub App](https://github.com/apps/konfig-bot) to your SDK
  repository. This allows Konfig to automatically create PRs and inspect your
  `konfig.yaml` file.
</Admonition>

## Push and Poll

Today there are two ways of automating SDK updates with Konfig:

- [GitHub Action](automate-sdk-updates#github-action)

  - Use GitHub Action if you version control your OAS and would like
    to keep the single source of truth in an existing repo. This is often the case
    if you also integrate with other documentation platforms or already have a
    git-based workflow for updating your OAS.

- [Polling](automate-sdk-updates#polling)
  - Use Polling when you do not version control your OAS and instead serve your OAS as a public endpoint

### GitHub Action

Add the following GitHub Action under `.github/workflows/konfig-push.yaml` to
the repository that hosts your OAS. Replace the following values with your own:

1. Production Branch (e.g. `main`)
2. Path to OpenAPI Specification (e.g. `specifications/api.yaml`)
3. Owner of SDK repository (e.g. `konfig-dev`)
4. Name of SDK repository (e.g. `acme-sdks`)

```yaml
name: konfig-push-openapi-spec
on:
  push:
    branches:
      # 1) Replace with name of your production branch
      - main
jobs:
  konfig-push-openapi-spec:
    runs-on: ubuntu-latest
    env:
      CLI_VERSION: 1.0.40
    steps:
      - uses: actions/checkout@v3
      - name: Cache node_modules
        id: cache-npm
        uses: actions/cache@v3
        with:
          # npm cache files are stored in "~/.npm" on Linux/macOS
          path: ~/.npm
          key: ${{ runner.os }}-konfig-push-build-${{ env.CLI_VERSION }}
      - name: Install Konfig CLI
        run: npm install -g konfig-cli@$CLI_VERSION
      - name: Push OpenAPI Spec
        # 2) Replace "api.yaml" with path to OAS
        # 3) Replace "konfig-dev" with owner of SDK repository
        # 4) Replace "acme-sdks" with name of repository
        run: konfig push -s api.yaml -o konfig-dev -r acme-sdks
```

### Polling

To setup polling please [setup a time](/schedule-demo) to talk to us and we will get you setup.

## Versioning and Publishing

Once an update is detected, Konfig will automatically generate a new version
following strict semantic versioning based on the diff between your current and
previous OpenAPI Spec. Upon merge of a PR, Konfig will automatically publish to
[Package Managers](docs/reference/supported-package-managers).
